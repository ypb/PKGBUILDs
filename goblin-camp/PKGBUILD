# Maintainer:  Michal Kowalski <kowalski TOD michal TA gmail TOD com>

pkgname=goblin-camp
pkgver=0.141
pkgrel=1
pkgdesc="Goblin Camp is a roguelike citybuilder, inspired by Anno 1404, Dwarf Fortress and Dungeon Keeper"
arch=('i686' 'x86_64')
url="http://www.goblincamp.com/"
license=('GPL3')
groups=('games' 'ypb')
depends=('libgl' 'python2' 'zlib' 'libpng' 'sdl' 'sdl_image' 'gcc-libs')
# bo bjam...
makedepends=('boost')
optdepends=()
provides=()
conflicts=('goblincamp-hg')
replaces=()
backup=()
options=()
install=
changelog=
source=(http://bitbucket.org/genericcontainer/goblin-camp/get/b57e5426c571.tar.bz2
        goblincamp.desktop goblincamp.png gc-config.jam patch-r1448.patch)
sha1sums=('264472197f3af575d59674af75ef845d3cbecf38'
          'fc18457e5931a97991049453d45a328dc60bbf9a'
          'deb45aaeee8e6200ff5ccda77c6256e14348ced8'
          '1c43773ce3185e3d4dba29e5da6ab3a6e3c55df6'
          'bd1633e16a26f38ccd439ca9fbbc8a028c5b159b')

build() {
  cd "$srcdir/genericcontainer-goblin-camp-b57e5426c571"

  patch -p1 < ../patch-r1448.patch
  cp ../gc-config.jam .
  bjam --user-config=gc-config.jam variant=release
}

package() {
  cd "$srcdir/genericcontainer-goblin-camp-b57e5426c571"

  mkdir -p $pkgdir/usr/{bin,share/{applications,pixmaps}}
  install -m644 $srcdir/goblincamp.desktop $pkgdir/usr/share/applications/goblin-camp.desktop
  install -m644 $srcdir/goblincamp.png $pkgdir/usr/share/pixmaps/goblin-camp.png
  install -m755 build/bin-${_variant}*/bin/goblin-camp $pkgdir/usr/bin/goblin-camp
  cp -r build/bin-${_variant}*/share/goblin-camp* $pkgdir/usr/share
}

# vim:set ts=2 sw=2 et:
